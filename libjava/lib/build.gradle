apply plugin: 'java'
apply from: 'build-config.gradle'

sourceCompatibility = 1.7
targetCompatibility = 1.7

dependencies {
    // Retrofit + Gson
    compile 'com.squareup.retrofit2:retrofit:2.1.0'
    compile 'com.squareup.retrofit2:converter-gson:2.1.0'
    compile 'com.squareup.okhttp3:logging-interceptor:3.5.0'

    // Testing
    testCompile 'junit:junit:4.12'
    testCompile 'org.hamcrest:hamcrest-junit:2.0.0.0'
    testCompile 'com.squareup.okhttp3:mockwebserver:3.5.0'
}

buildConfig {
    packageName = 'com.mapbox.services'
    constants = [
        VERSION: project.VERSION_NAME,
        GIT_REVISION: getGitRevision(),
    ]
}

task JavadocGeneration(type: Javadoc) {
    source = sourceSets.main.allJava
    failOnError = false
    classpath = configurations.compile
}

def getGitRevision() {
    def cmd = "git rev-parse --short HEAD"
    def proc = cmd.execute()
    def ref = proc.text.trim()
    return ref
}

apply from: 'gradle-mvn-push.gradle'
apply from: 'gradle-checkstyle.gradle'
